{% extends 'new_base.html' %}
{% block profile %}<i class="fa-regular fa-user"></i>{{ username }}{% endblock %}
{% block profile2 %}<i class="fa-regular fa-user"></i>{{ username }}{% endblock %}


{% block content %}
<style>
  .first {
  width: 100%;
  height: 10vh;
  border-radius: 20px;
  line-height: 4.9vh;
  
}

 .second {
  height: 40vh;
  border-radius: 20px;

 }

 .third {
  height: 16vh;
  border-radius: 1.6vw;
  overflow: scroll;
 }

 .word1 {
   /* position: relative;/*
    /*top: 0.2vh;/*
    /*left:2vw; 5px */
    text-align: center;
    font-size: 2vh;
    padding-top: 0;
 }

 .num {
  position: relative;
  top: -3.5vh;
  /*left: 2vw; -25px   arrow top = -20px  top: -3.vh;*/
  text-align: center;
  font-size: 4.2vh;
 }

 .fa-caret-down{
  font-size: 1.2vw;
  color:red;
  position: absolute;
  top: -0.6vh;
  left: 7px;
 }

 .fa-caret-up{
  font-size: 1.2vw;
  color:green;
  position: absolute;
  top: -0.6vh;
  left: 7px;
}

.fa-stop{
  font-size: 1.2vw;
  /*color:green; */
  position: absolute;
  top: -0.6vh;
  left: 7px;
}

.arrow {
  position: relative;
  
}

.leader-table{
  font-weight: 500;
  font-size: 1em;
  margin-bottom: 0;
  padding-bottom: 0;
  padding-left: 15px;
}


/*Table style begin*/
#table{
  box-sizing: border-box;
  padding-top: 0;
  margin-top: 0;
}

#myInput {
  background-image: url('/css/searchicon.png');
  background-position: 10px 10px;
  background-repeat: no-repeat;
  width: 100%;
  font-size: 16px;
  padding: 12px 20px 12px 40px;
  border: 1px solid #ddd;
  margin-bottom: 12px;
}

#myTable {
  border-collapse: collapse;
  width: 100%;
  border: 1px solid #ddd;
  font-size: 18px;
}

#myTable th, #myTable td {
  text-align: left;
  padding: 4px;
}

#myTable tr {
  border-bottom: 1px solid #ddd;
}

#myTable tr.header, #myTable tr:hover {
  background-color: #f1f1f1;
}

#myTable{
  font-size: 0.8vw;
}
/*Table style end   font-size: 0.7em */
#form-button {
  background-color: #ffea00;
  color:black;
/*
  position:relative;
  top: 10%;
  margin-top: 1vh;
*/
 
  padding: 0 5px;
  height:20px;
}

.flag{
  /*  right:35px top:10px; pics right: 18px;top: -17px;  */
  /* position: relative;
  border-radius: 50%;
  left: -2.5vw */

  /* right:10.8vh;
  top:0.9vh; */
}

.pics{
  position: relative;
  left: -4.5vw; 

  /* right: 9.2vh;*/
  /* top: 10vh;   */

}  

#form-button:hover{
  background-color: #555;
  color: white;
}

.current{
 /* border-top-style: double;*/
  width: 100%;
 /* height: 140px;*/
}

.runner{
  border-top-style: double;
  width: 100%;
  height: 70px;
}

.Tpics{
  border-radius: 50%;
}

.trend {
  width: 25%;
  height: 100%;
  position: absolute;
  top: -0.7vw;
  left: 10vw;
}

.countr{
  font-size: 1vw;
}

.tileh{
  font-size: 1.8vh;
}

.tilev{
   font-size: 2vh;
}
.tile{
  height: 50px;
}
.card-header{
  background-color: #ffea00;
}
</style>




<div class="container-fluid overflow-hidden">
  <h2 style="margin-top: 1vh; font-size: 3vh;padding: 0;">Dashboard</h2>
  <p id="today" style="margin-top:0px; margin-bottom: 10px auto; font-size: 1.4vh;"></p>
  


  <div class="row gx-5 gy-3 bg-secondary pb-1 pt-1">

    <div class="col-md-3 ">
      <div class="col ">
        <div class="card text-center text-black  mb-3 " id="orders-pending">
          <div id="bbglp1"  class="card-header">
            <h5 class="card-title tileh">Calls Counted</h5>
          </div>
          <div class="card-body">
            <h3 class="card-title tilev">{{total_calls}}<i class="arrow fa {{ kpi_increment_list.1 }}"></i></h3>
            <p style="font-size: 1.5vh;padding-bottom: 0;margin-bottom: 0;"><small>Average: {{avg_kpi_dic.calls}}</small></p>
            <p style="font-size: 1.5vh;"><small>Total: {{total_kpi_dic.calls}}</small></p>
          </div>
        </div>
      </div>
    </div>


    <div class="col-md-3 ">
      <div class="col">
        <div class="card text-center text-black  mb-3 " id="orders-pending">
          <div id="bbglp2"  class="card-header ">
            <h5 class="card-title tileh">Agent Collection{{curr_sign}}</h5>
          </div>
          <div class="card-body">
            <h3 class="card-title tilev">{{total_paid_sum}}<i class="arrow fa {{ kpi_increment_list.0 }}"></i></h3>
            <p style="font-size: 1.5vh;padding-bottom: 0;margin-bottom: 0;"><small>Average: {{avg_kpi_dic.paid}}</small></p>
            <p style="font-size: 1.5vh;"><small>Total: {{total_kpi_dic.paid}}</small></p>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3 ">
      <div class="col">
        <div class="card text-center text-black  mb-3 " id="orders-pending">
          <div id="bbglp3"  class="card-header ">
            <h5 class="card-title tileh">Average Talk Time</h5>
          </div>
          <div class="card-body">
            <h3 class="card-title tilev">{{current_ATT}}<i class="arrow fa {{ kpi_increment_list.3 }}"></i></h3>
            <p style="font-size: 1.5vh;padding-bottom: 0;margin-bottom: 0;"><small>Average: {{avg_kpi_dic.ATT}}</small></p>
            <p style="font-size: 1.5vh;"><small>Total: {{total_kpi_dic.ATT}}</small></p>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3 ">
      <div class="col">
        <div class="card text-center text-black  mb-3 " id="orders-pending">
          <div id="bbglp4"  class="card-header ">
            <h5 class="card-title tileh">Negotiation Rate</h5>
          </div>
          <div class="card-body">
            <h3 class="card-title tilev">{{negotiation_r}}%<i class="arrow fa {{ kpi_increment_list.2 }}"></i></h3>
            <p style="font-size: 1.5vh;padding-bottom: 0;margin-bottom: 0;"><small>Average: {{avg_kpi_dic.negotiation}}</small></p>
            <p style="font-size: 1.5vh;"><small>Total: {{total_kpi_dic.negotiation}}</small></p>
          </div>
        </div>
      </div>
    </div>

 
  </div>
  
    <div class="row gx-5 gy-3 mt-3 mb-1  pb-2 " style="background-color: #ffea00;"> <!--bg-secondary-->

    <div class="col-md-7">
      <div id="table" class="second p-0 border bg-light" style="overflow-x:auto;overflow-y:auto;">
        <p class="leader-table" style="font-size: 1.2vw;">{{ scan_country }} Leaderboard {{ date_range }}</p>
        <form method="post" style="padding-top: 0;margin-top: 0;">
          {% csrf_token %}
          <div class="container">
          <div class="row">
           <div class="form-group col-md-3" style="font-size: 0.9vw;">
                <label class="drop" for="inputState">Country</label>
                <select id="country" class="form-control" name="country" style="height: 2vh; padding-top: 0; padding-bottom: 0; font-size: 1.2vh;">
                  <option value="" selected>All</option>
                  <option value="Nigeria">Nigeria</option>
                  <option value="Kenya">Kenya</option>
                  <option value="Tanzania">Tanzania</option>
                  <option value="Uganda">Uganda</option>
                  <option value="Togo">Togo</option>
                  <option value="Malawi">Malawi</option>
                </select>
           </div>
           <div class="form-group col-md-3" style="font-size: 0.9vw;">
                <label class="drop" for="inputState">Duration</label>
                <select id="inputState" class="form-control" name="date-range" style="height: 2vh; padding-top: 0; padding-bottom: 0; font-size: 1.2vh;"> <!-- height: 20px; padding-top: 0; font-size: 0.8em;0.7vw -->
                  <option value="MTD" selected>MTD</option>
                  <option value="WTD">WTD</option>
                </select>
           </div>
           <div class="form-group col-md-3" style="font-size: 0.9vw;">
            <label class="drop" for="inputState">Currency</label>
            <select id="inputState" class="form-control" name="currency" style="height: 2vh; padding-top: 0; padding-bottom: 0; font-size: 1.2vh;"> <!-- height: 20px; padding-top: 0; font-size: 0.8em;0.7vw -->
              <option value="local" selected>Local</option>
              <option value="USD">USD</option>
            </select>
          </div>
           <div class="form-group col-md-3" style="font-size: 0.75vw;">
            <label class="drop" for="form-button" style="visibility: hidden;">filter</label><br>
            <button id="form-button" type="submit" class="btn btn-primary" style="font-size: 1.2vh; height: 2vh; padding-top: 0; padding-bottom: 0;">Filter</button>
          </div>
         </div>
        </div>
        </form>

<table id="myTable">
  <tr class="header" style="background-color: #ffea00;">
    <th style="width:5%;">Pos</th>
    <th style="width:25%;">Name</th>
    <th style="width:10%;">Country</th>
    <th style="width:10%;">Calls</th>
    <th style="width:10%;">Collection{{curr_sign}}</th>
    <th style="width:10%;">Average Talk Time</th>
    <th style="width:10%;">Negotiation Rate</th>
  </tr>
  {% for item in combined_list %}
  <tr>
    <td></td>
    <td><img class="Tpics" src="../static/img_avatar.png" style="height: 12%;width:12%" >{{ item.0 }}</td> <!-- height="30px" width="30px" -->
    <td>{{ item.5 }}</td>
    <td>{{ item.2 }}</td>
    <td>{{ item.1 }}</td>
    <td>{{ item.3 }}</td>
    <td>{{ item.4 }}%</td>
  </tr>
  {% endfor %}
</table>
<a href=# class="" data-bs-toggle="modal" data-bs-target="#myModal" style="font-size: 1vw;">See the whole Leaderboard</a>

      </div>
    </div>
    <div class="col-md-5">
      <div class="second p-3 border bg-light" style="text-align:center;">        
        <h3 style="font-size: 1.7vw;">&#127881; Current winner &#127881;</h3>
        <img src="../static/img_avatar.png"  style="border-radius: 3.5vh; display: block; margin-left: auto; margin-right: auto;height: 35%;width: 30%;"><!--height="120px" width="160px" -->
      <div style="font-size: 1.1vw;">Congratulations {{ combined_list.0.0 }} on your outstanding achievement leading the pack. Your determination is admirable!</div>
      </div>
    </div>

    </div>

    <h2 style="text-align: center; font-size: 2.5vh;">Current {{ date_range }} top performers</h2>



    



    <div class="row gx-5 gy-3 bg-secondary pb-1 pt-1 mt-1">



      <div class="container">
        <div class="row">

            <div class="col-md-3">
                <div class="card text-center text-black mb-3" id="orders-pending">
                    <div id="bbglp1" class="card-header">
                        <div style="display: inline;">
                            <img class="pics" src="../static/img_avatar.png" width="40" height="40" style="height: auto; width: 20%;">
                            <img class="flag" src="../static/Uganda.png" style="height: 10%; width: 5%;">
                        </div>
                        <span class="countr">Uganda</span>
                    </div>
                    <div class="card-body">
                        <div class="current" style="font-size: 2vh; text-align: center;">{{ first_in_country.Uganda }}
                            <p style="font-size: 1.3vh; text-align: center;">Having {{ combined_list_top_in_country.3.2 }}
                                connected calls, {{ combined_list_top_in_country.3.4 }} collection, and {{combined_list_top_in_country.3.3 }}% average negotiation rate</p>
                        </div>
                    </div>
                </div>
            </div>


            <div class="col-md-3">
              <div class="card text-center text-black mb-3" id="orders-pending">
                  <div id="bbglp1" class="card-header">
                      <div style="display: inline;">
                          <img class="pics" src="../static/img_avatar.png" width="40" height="40" style="height: auto; width: 20%;">
                          <img class="flag" src="../static/Flag-Nigeria.webp" style="height: 10%; width: 5%;">
                      </div>
                      <span class="countr">Nigeria</span>
                  </div>
                  <div class="card-body">
                      <div class="current" style="font-size: 2vh; text-align: center;">{{ first_in_country.Nigeria }} 
                          <p style="font-size: 1.3vh; text-align: center;">Having {{ combined_list_top_in_country.0.2 }} connected calls, {{ combined_list_top_in_country.0.4 }} collection,
                             and {{ combined_list_top_in_country.0.3 }}% average negotiation rate</p>
                      </div>
                  </div>
              </div>
          </div>

          <div class="col-md-3">
            <div class="card text-center text-black mb-3" id="orders-pending">
                <div id="bbglp1" class="card-header">
                    <div style="display: inline;">
                        <img class="pics" src="../static/img_avatar.png" width="40" height="40" style="height: auto; width: 20%;">
                        <img class="flag" src="../static/kenya.png" style="height: 10%; width: 5%;">
                    </div>
                    <span class="countr">Kenya</span>
                </div>
                <div class="card-body">
                    <div class="current" style="font-size: 2vh; text-align: center;">{{ first_in_country.Kenya }}
                        <p style="font-size: 1.3vh; text-align: center;">Having {{ combined_list_top_in_country.1.2 }} connected calls, {{ combined_list_top_in_country.1.4 }}
                          collection, and {{ combined_list_top_in_country.1.3 }}% average negotiation rate</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-3">
          <div class="card text-center text-black mb-3" id="orders-pending">
              <div id="bbglp1" class="card-header">
                  <div style="display: inline;">
                      <img class="pics" src="../static/img_avatar.png" width="40" height="40" style="height: auto; width: 24%;padding-left: 1.6vh;">
                      <img class="flag" src="../static/Flag_of_Tanzania.svg.png" style="height: 10%; width: 5%;">
                  </div>
                  <span class="countr">Tanzania</span>
              </div>
              <div class="card-body">
                  <div class="current" style="font-size: 2vh; text-align: center;">{{ first_in_country.Tanzania }}
                      <p style="font-size: 1.3vh; text-align: center;">Having {{ combined_list_top_in_country.2.2 }} connected calls,
                        {{ combined_list_top_in_country.2.4 }} collection, and {{ combined_list_top_in_country.2.3 }}% average negotiation rate</p>
                  </div>
              </div>
          </div>
      </div>

            
        </div>
    </div>
  

      <!-- <div class="col-md-3 ">
        <div class="col ">
          <div class="card text-center text-black  mb-3 " id="orders-pending">
            <div id="bbglp1"  class="card-header">
              <div style="display: inline;">
                <img class="pics" src="../static/img_avatar.png" width="40" height="40" style="height:auto; width:20%"> 
                <img class="flag" src="../static/Uganda.png" style="height:10%; width:5%"> 
              </div>
              <span class="countr">Uganda</span>
            </div>
            <div class="card-body">
             
              <div class="current" style="font-size: 2vh;text-align: center;">{{ first_in_country.Uganda }} <p style="font-size: 1.3vh;text-align: center;">Having {{ combined_list_top_in_country.3.2 }} connected calls, {{ combined_list_top_in_country.3.4 }} collection, and {{ combined_list_top_in_country.3.3 }}% average negotiation rate</p></div>      
            </div>
          </div>
        </div>
      </div> -->


      <!-- <div class="col-md-3 ">
        <div class="col ">
          <div class="card text-center text-black  mb-3 " id="orders-pending">
            <div id="bbglp1"  class="card-header">
              <div style="display: inline;">
                <img class="pics" src="../static/img_avatar.png" style="height:40%; width:20%" > 
                <img class="flag" src="../static/Uganda.png" style="height:10%; width:5%"> 
              </div>
              <span class="countr">Uganda</span>
            </div>
            <div class="card-body">
             
              <div class="current" style="font-size: 2vh;text-align: center;">{{ first_in_country.Uganda }} <p style="font-size: 1.3vh;text-align: center;">Having {{ combined_list_top_in_country.3.2 }} connected calls, {{ combined_list_top_in_country.3.4 }} collection, and {{ combined_list_top_in_country.3.3 }}% average negotiation rate</p></div>      
            </div>
          </div>
        </div>
      </div>



      <div class="col-md-3 ">
        <div class="col ">
          <div class="card text-center text-black  mb-3 " id="orders-pending">
            <div id="bbglp1"  class="card-header">
              <div style="display: inline;">
                <img class="pics" src="../static/img_avatar.png" style="height:40%; width:20%" > 
                <img class="flag" src="../static/Uganda.png" style="height:10%; width:5%"> 
              </div>
              <span class="countr">Uganda</span>
            </div>
            <div class="card-body">
             
              <div class="current" style="font-size: 2vh;text-align: center;">{{ first_in_country.Uganda }} <p style="font-size: 1.3vh;text-align: center;">Having {{ combined_list_top_in_country.3.2 }} connected calls, {{ combined_list_top_in_country.3.4 }} collection, and {{ combined_list_top_in_country.3.3 }}% average negotiation rate</p></div>      
            </div>
          </div>
        </div>
      </div>

    
      <div class="col-md-3 ">
        <div class="col ">
          <div class="card text-center text-black  mb-3 " id="orders-pending">
            <div id="bbglp1"  class="card-header">
              <div style="display: inline;">
                <img class="pics" src="../static/img_avatar.png" style="height:40%; width:20%" > 
                <img class="flag" src="../static/Uganda.png" style="height:10%; width:5%"> 
              </div>
              <span class="countr">Uganda</span>
            </div>
            <div class="card-body">
             
              <div class="current" style="font-size: 2vh;text-align: center;">{{ first_in_country.Uganda }} <p style="font-size: 1.3vh;text-align: center;">Having {{ combined_list_top_in_country.3.2 }} connected calls, {{ combined_list_top_in_country.3.4 }} collection, and {{ combined_list_top_in_country.3.3 }}% average negotiation rate</p></div>      
            </div>
          </div>
        </div>
      </div>
 -->

   <!--   <div class="row  gy-3 bg-secondary pb-2 mt-2"> 

   <div class="col-lg-3 col-md-6 col-sm-6">
      <div class="third p-3 border bg-light">
        <div style="display: inline;">
          <img class="pics" src="../static/img_avatar.png" style="height:40%; width:20%" > 
          <img class="flag" src="../static/Uganda.png" style="height:10%; width:5%">
        </div>
        <span class="countr">Uganda</span>
        <div class="current" style="font-size: 2vh;text-align: center;">{{ first_in_country.Uganda }} <p style="font-size: 1.3vh;text-align: center;">Having {{ combined_list_top_in_country.3.2 }} connected calls, {{ combined_list_top_in_country.3.4 }} collection, and {{ combined_list_top_in_country.3.3 }}% average negotiation rate</p></div>
      </div>
    </div> 
    <div class="col-lg-3 col-md-6 col-sm-6">
      <div class="third p-3 border bg-light">
        <div style="display: inline;">
          <img class="pics" src="../static/img_avatar.png"  style="height:40%; width:20%">
          <img class="flag" src="../static/Flag-Nigeria.webp" style="height:10%; width:5%">
        </div>
        <span class="countr">Nigeria</span>
        <div class="current" style="font-size: 2vh;text-align: center;">{{ first_in_country.Nigeria }}<p style="font-size: 1.3vh;text-align: center;">Having {{ combined_list_top_in_country.0.2 }} connected calls, {{ combined_list_top_in_country.0.4 }} collection, and {{ combined_list_top_in_country.0.3 }}% average negotiation rate</p></div>
      </div>
    </div>
    <div class="col-lg-3 col-md-6 col-sm-6">
      <div class="third p-3 border bg-light">
        <div style="display: inline;">
          <img class="pics" src="../static/img_avatar.png"  style="height:40%; width:20%">
          <img class="flag" src="../static/kenya.png" style="height:10%; width:5%">
        </div>
        <span class="countr">Kenya</span>
        <div class="current" style="font-size: 2vh;text-align: center;">{{ first_in_country.Kenya }}<p style="font-size: 1.3vh;text-align: center;">Having {{ combined_list_top_in_country.1.2 }} connected calls, {{ combined_list_top_in_country.1.4 }}
           collection, and {{ combined_list_top_in_country.1.3 }}% average negotiation rate</p></div>
    
      </div>
    </div>
    <div class="col-lg-3 col-md-6 col-sm-6">
      <div class="third p-3 border bg-light">
        <div style="display: inline;">
          <img class="pics" src="../static/img_avatar.png"  style="height:40%; width:20%">
          <img class="flag" src="../static/Flag_of_Tanzania.svg.png" style="height:10%; width:5%">
        </div>
        <span class="countr">Tanzania</span>
        <div class="current" style="font-size: 2vh;text-align: center;">{{ first_in_country.Tanzania }}<p style="font-size: 1.3vh;text-align: center;">Having {{ combined_list_top_in_country.2.2 }} connected calls,
           {{ combined_list_top_in_country.2.4 }} collection, and {{ combined_list_top_in_country.2.3 }}% average negotiation rate</p></div>
      </div>
    </div>
    -->
  <!-- </div>
</div> -->

</div>

<!--2nd  Modal 

<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal">
   Open modal
</button>
</div>
-->
<!-- The Modal -->
<div class="modal" id="myModal">
<div class="modal-dialog modal-xl">
  <div class="modal-content">

    <!-- Modal Header -->
    <div class="modal-header">
      <h4 class="modal-title">{{ scan_country }} Leaderboard {{ date_range }}</h4>
      <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
    </div>

    <!-- Modal body -->
    <div class="modal-body">
      <table id="myTable2">
        <tr class="header" style="background-color: #ffea00;position: sticky;top: 0;">
          <th style="width:5%;">Pos</th>
          <th style="width:25%;">Name</th>
          <th style="width:10%;">Country</th>
          <th style="width:10%;">Calls</th>
          <th style="width:10%;">Collection</th>
          <th style="width:10%;">Average Talk Time</th>
          <th style="width:10%;">Negotiation Rate</th>
        </tr>
        {% for item in longer_list %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td><img class="Tpics" src="../static/img_avatar.png" height="30px" width="30px">{{ item.0 }}</td>
          <td>{{ item.5 }}</td>
          <td>{{ item.2 }}</td>
          <td>{{ item.1 }}</td>
          <td>{{ item.3 }}</td>
          <td>{{ item.4 }}%</td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <!-- Modal footer -->
    <div class="modal-footer">
      <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
    </div>

  </div>
</div>
</div>


<script>


  function addSN(){
    var table = document.getElementById("myTable");
    var rows = table.rows;
    for (var i =1;i< rows.length; i++){
      var SN = rows[i].cells[0];
      SN.textContent=i;
    }
  }

  addSN()


  //plotly line

const xArray1 = [1,2,3,4,5];
const yArray1 = [30,70,200,180,230,];

// Define Data
const data1 = [{
  x: xArray1,
  y: yArray1,
  mode:"lines"
}];

// Define Layout
const layout1 = {
  font: {
    autosize: false,
    width: 5000,
    height: 5000,
    margin: {
    l: 0,
    r: 0,
    b: 0,
    t: 0,
    pad: 0
  },
    family: 'Courier New, monospace',
    //size: 5,
    //color: '#7f7f7f'
  },
  xaxis: {range: [1, 5]},
  yaxis: {range: [1, 300]},  
};

// Display using Plotly
Plotly.newPlot("plot1", data1, layout1);



const theInterval = setInterval(myTimer, 1000);

function myTimer() {
  const date = new Date();
  document.getElementById("today").innerHTML = date;
}

  
  </script>
  
{% endblock %}